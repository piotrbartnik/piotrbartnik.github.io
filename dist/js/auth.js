"use strict";var tags,loginPanel=document.querySelector("#loginPanel"),appBody=document.querySelector("#app"),userRegisterData=document.querySelector("#registerDataContainer"),editDataContainer=document.querySelector("#editDataContainer"),userWrapper=document.getElementsByClassName("user-data__wrapper")[0],searchUser=document.querySelector(".search-user"),dashboard=document.querySelector("#dashboard"),editProfile=document.querySelector("#userEditProfile"),yourProfile=document.querySelector("#userProfile"),registerError=document.querySelector("#register-error"),loginError=document.querySelector("#login-error");auth.signOut(),auth.onAuthStateChanged(function(e){e?(db.collection("users").onSnapshot(function(e){userColections(e.docs),tags=document.querySelectorAll(".tag_el");for(var t=0;t<tags.length;t++)tags[t].addEventListener("click",function(e){return function(){var t=tags[e].innerHTML.replace(/\s\(\d+\)\,/,"").trim();db.collection("users").onSnapshot(function(e){userPrint(e.docs,t)})}}(t))},function(e){console.log(e.message)}),db.collection("users").doc(e.uid).get().then(function(e){var t=e.data();(Object.entries(t).length<4||""===t.academy)&&(console.log("nie ma danych w bazie danych"),userRegisterData.style.display="flex",userWrapper.style.display="none",searchUser.style.display="none",dashboard.style.display="none",editProfile.style.display="none",yourProfile.style.display="none")})):console.log("user logged out.")});var createForm=document.querySelector("#userRegisterData");createForm.addEventListener("submit",function(e){e.preventDefault(),auth.onAuthStateChanged(function(e){db.collection("users").doc(e.uid).update({academy:createForm.userRegisterSchool.value,hobby:createForm.userRegisterHobby.value.split(","),skills:createForm.userRegisterSkills.value.split(","),crazy_skills:createForm.userRegisterCrazySkills.value.split(",")}).then(function(){userRegisterData.style.display="none",userWrapper.style.display="flex",searchUser.style.display="flex",dashboard.style.display="",editProfile.style.display="",yourProfile.style.display=""}).catch(function(e){console.log(e.message)})})});var accountDetails=document.querySelector("#userProfile"),accountDetailsBody=document.querySelector("#registerUserData");accountDetails.addEventListener("click",function(){auth.onAuthStateChanged(function(e){db.collection("users").doc(e.uid).get().then(function(e){var t='\n      <div class="col-md-6 mt-2 user-info">\n        <ul class="list-group list-group-flush">\n          <li class="list-group-item">Zalogowany jako: '.concat(e.data().name,'</li>\n          <li class="list-group-item">Uczelnia: ').concat(e.data().academy,'</li>\n          <li class="list-group-item">Hobby: ').concat(e.data().hobby,'</li>\n          <li class="list-group-item">Umiejętności : ').concat(e.data().skills,'</li>\n          <li class="list-group-item">Szalone umiejętności: ').concat(e.data().crazy_skills,"</li>\n        </ul>\n      </div>\n    ");registerUserData.innerHTML=t,registerUserData.style.display="flex",editDataContainer.style.display="none",userWrapper.style.display="none",searchUser.style.display="none"})})});var userEditProfile=document.querySelector("#userEditProfile");userEditProfile.addEventListener("click",function(){editDataContainer.style.display="flex",registerUserData.style.display="none",userWrapper.style.display="none",searchUser.style.display="none  ",auth.onAuthStateChanged(function(e){db.collection("users").doc(e.uid).get().then(function(e){editForm.userEditSchool.value=e.data().academy,editForm.userEditHobby.value=e.data().hobby,editForm.userEditSkills.value=e.data().skills,editForm.userEditCrazySkills.value=e.data().crazy_skills})})});var editForm=document.querySelector("#userEditData");editForm.addEventListener("submit",function(e){e.preventDefault(),auth.onAuthStateChanged(function(e){db.collection("users").doc(e.uid).update({academy:editForm.userEditSchool.value,hobby:editForm.userEditHobby.value.split(","),skills:editForm.userEditSkills.value.split(","),crazy_skills:editForm.userEditCrazySkills.value.split(",")}).then(function(){editDataContainer.style.display="none",userWrapper.style.display="flex",searchUser.style.display="flex"}).catch(function(e){console.log(e.message)})})}),dashboard.addEventListener("click",function(){registerUserData.style.display="none",editDataContainer.style.display="none",userWrapper.style.display="flex",searchUser.style.display="flex"});var signupForm=document.querySelector("#userRegister");signupForm.addEventListener("submit",function(e){console.log("test rejestracji przeszedł pomyślnie"),e.preventDefault(),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var t=signupForm.registerUserEmail.value,r=signupForm.registerUserPassword.value,s=t.split("."),o=signupForm.registerUserName;/([a-z]+\.){2}benhauer(\+[a-z0-9]+)?\@gmail\.com/.test(t)?(o.value=s[0].capitalize()+" "+s[1].capitalize(),auth.createUserWithEmailAndPassword(t,r).then(function(e){return db.collection("users").doc(e.user.uid).set({name:o.value})}).then(function(){console.log("test rejestracji przeszedł pomyślnie"),loginPanel.remove(),appBody.style.display="block"})):(registerError.style.display="block",setTimeout(function(){registerError.style.display="none"},5e3))});var loginForm=document.querySelector("#userLogin");loginForm.addEventListener("submit",function(e){e.preventDefault();var t=loginForm.loginUserEmail.value,r=loginForm.loginUserPassword.value;console.log(t),/([a-z]+\.){2}benhauer(\+[a-z0-9]+)?\@gmail\.com/.test(t)&&t||(loginError.style.display="block",setTimeout(function(){loginError.style.display="none"},5e3)),auth.signInWithEmailAndPassword(t,r).then(function(e){console.log("test loginu przeszedł pomyślnie"),loginPanel.remove(),appBody.style.display="block"})});var logout=document.querySelector("#userLogOut");logout.addEventListener("click",function(e){e.preventDefault(),auth.signOut(),location.reload()});